{"version":3,"sources":["redux/types.tsx","redux/actions.tsx","components/MainMapGl.tsx","App.tsx","components/MainMapStyle.ts","components/MapComponents/MapRouteInfo.tsx","components/MapComponents/MapInputAdress.tsx","components/MapComponents/MapPointDataError.tsx","components/MapComponents/MapRouteBind.tsx","components/MapServiceFunctions.tsx","redux/massdkReducer.tsx","redux/massrouteReducer.tsx","redux/mapReducer.tsx","redux/rootReducer.tsx","index.tsx"],"names":["MASSDK_CREATE","MAP_CREATE","MASSROUTE_CREATE","massrouteCreate","massRouter","type","data","activeRoute","dateMapGl","dateRouteGl","styleApp01","fontSize","marginRight","width","maxHeight","minHeight","backgroundColor","color","textTransform","styleTypography","textAlign","styleModalEnd","position","top","left","right","height","styleSetInf","marginTop","marginLeft","bgcolor","border","borderColor","borderRadius","boxShadow","p","styleSetPoint","styleModalEndMapGl","styleModalMenu","marginBottom","styleSet","styleInpKnop","maxWidth","minWidth","styleSetAdress","styleBoxForm","MapRouteInfo","props","React","openSetInf","setOpenSetInf","handleCloseSetEndInf","setOpen","dlRoute1","tmRoute1","Math","round","properties","get","value","tm","text","substring","length","console","log","Modal","open","onClose","hideBackdrop","Box","sx","Button","onClick","name1","name2","MapInputAdress","massdk","useSelector","state","massdkReducer","openSetAdress","setOpenSetAdress","iPoint","nameCoordinates","valuen","setValuen","handleCloseSetAdr","Grid","item","container","xs","component","noValidate","autoComplete","TextField","size","onKeyPress","event","key","preventDefault","inputProps","style","onChange","target","variant","MapPointDataError","openSetEr","setOpenSetEr","reason","Typography","sErr","MapRouteBind","openSetBind","setOpenSetBind","handleCloseSetEndBind","DecodingCoord","coord","split","map","Number","CodingCoord","String","DoublRoute","massroute","pointA","pointB","flDubl","pointAcod","pointBcod","i","starts","stops","getPointData","index","pointAaIndex","pointBbIndex","textBalloon","hintContent","iconContent","getPointOptions","colorBalloon","newCoordinates","preset","getReferencePoints","referencePoints","coordinates","coordStart","coordStop","coordStartIn","coordStopIn","massRoute","debugging","flagOpen","propsOpen","massrouteOpen","flagPusk","flagRoute","flagBind","flagDemo","chNewCoord","homeRegion","pointCenter","pointCenterOld","pointAa","pointBb","indexPoint","soobError","MainMap","flag","ws","url","massrouteReducer","tt","Object","keys","mapReducer","dateMap","tflight","dispatch","useDispatch","region","vertexes","masskPoint","ID","area","dgis","name","push","splice","aY","aX","bY","bX","coord0","coord1","CenterCoord","boxPoint","point0","Y","X","point1","massdkCreate","zoom","setZoom","openSet","setOpenSet","ZeroRoute","setSize","window","innerWidth","random","MakeRecordMassRoute","ways","masskRoute","sourceArea","sourceID","targetArea","targetID","lsource","ltarget","time","RecordMassRoute","mapState","center","yandexMapDisablePoiInteractivity","MapGl","mapp","pointAA","pointa","pointBB","pointb","MakeRoute","OnPlacemarkClickPoint","MakeСollectionRoute","ModalPressBalloon","openSetErBall","setOpenSetErBall","pointRoute","StrokaPressBalloon","soob","mode","param","massRouteRab","coordPoint","start","stop","handleClose","query","apikey","lang","modules","instanceRef","ref","current","events","add","e","codCoord","hint","coords","MapNewPoint","handleSendOpen","readyState","WebSocket","OPEN","send","JSON","stringify","setTimeout","originalEvent","button","getZoom","onLoad","ymaps","multiRoute","multiRouter","MultiRoute","routeActiveStrokeWidth","routeStrokeWidth","massPolyRoute","Polyline","balloonContent","balloonCloseButton","strokeColor","strokeWidth","geoObjects","massMultiRoute","routeStrokeStyle","massMultiRouteIn","routeActiveStrokeColor","model","getActiveRoute","coordinate","idx","geometry","options","float","provider","updateSize","addEventListener","removeEventListener","StrokaMenuGlob","pa","PressMenuButton","flagOpenWS","WS","App","host","location","pathname","search","pageUrl","URL","href","searchParams","useEffect","onopen","onclose","onerror","onmessage","allData","parse","intialState","rootReducer","combineReducers","action","store","createStore","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.506ea534.chunk.js","sourcesContent":["// export const INCREMENT = 'INCREMENT';\r\n// export const DECREMENT = 'DECREMENT';\r\n// export const INPUT_TEXT = 'INPUT_TEXT';\r\nexport const COMM_CREATE = 'COMM_CREATE';\r\nexport const MASSDK_CREATE = 'MASSDK_CREATE';\r\nexport const MAP_CREATE = 'MAP_CREATE';\r\nexport const MASSROUTE_CREATE = 'MASSROUTE_CREATE';\r\n","//import { INCREMENT, DECREMENT, INPUT_TEXT, COMM_CREATE, MASSFAZ_CREATE } from './types';\r\nimport {\r\n  MAP_CREATE,\r\n  //COMM_CREATE,\r\n  MASSDK_CREATE,\r\n  MASSROUTE_CREATE,\r\n} from \"./types\";\r\n\r\n//import { DateRPU } from './../interfaceRPU.d';\r\nimport { DateMAP } from \"./../interfaceMAP.d\";\r\nimport { DateRoute } from './../interfaceRoute.d';\r\n//import { Tflight } from './../interfaceMAP.d';\r\nimport { Pointer } from \"./../App\";\r\n//import { Router } from \"./../App\";\r\n\r\n// export function incrementLikes() {\r\n//   return {\r\n//     type: INCREMENT,\r\n//   };\r\n// }\r\n\r\n// export function decrementLikes() {\r\n//   return {\r\n//     type: DECREMENT,\r\n//   };\r\n// }\r\n\r\n// export function commCreate(dateRpu: DateRPU) {\r\n//   return {\r\n//     type: COMM_CREATE,\r\n//     data: { dateRpu },\r\n//   };\r\n// }\r\n\r\nexport function massdkCreate(massDka: Pointer[] = []) {\r\n  return {\r\n    type: MASSDK_CREATE,\r\n    data: massDka,\r\n  };\r\n}\r\n\r\nexport function mapCreate(dateMap: DateMAP) {\r\n  //export function mapCreate(dateMap: Tflight[]) {\r\n  return {\r\n    type: MAP_CREATE,\r\n    data: { dateMap },\r\n  };\r\n}\r\n\r\nexport function massrouteCreate(massRouter: DateRoute) {\r\n  return {\r\n    type: MASSROUTE_CREATE,\r\n    data: massRouter,\r\n  };\r\n}\r\n","import * as React from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { massdkCreate, massrouteCreate } from \"./../redux/actions\";\r\n\r\nimport Grid from \"@mui/material/Grid\";\r\nimport Box from \"@mui/material/Box\";\r\nimport Button from \"@mui/material/Button\";\r\nimport Modal from \"@mui/material/Modal\";\r\nimport Typography from \"@mui/material/Typography\";\r\n\r\nimport { YMaps, Map, Placemark, FullscreenControl } from \"react-yandex-maps\";\r\nimport { GeolocationControl } from \"react-yandex-maps\";\r\nimport { RulerControl, SearchControl } from \"react-yandex-maps\";\r\nimport { TrafficControl, TypeSelector, ZoomControl } from \"react-yandex-maps\";\r\n\r\nimport MapRouteInfo from \"./MapComponents/MapRouteInfo\";\r\nimport MapInputAdress from \"./MapComponents/MapInputAdress\";\r\nimport MapPointDataError from \"./MapComponents/MapPointDataError\";\r\nimport MapRouteBind from \"./MapComponents/MapRouteBind\";\r\n\r\nimport { MapNewPoint, RecordMassRoute } from \"./MapServiceFunctions\";\r\nimport { DecodingCoord, CodingCoord } from \"./MapServiceFunctions\";\r\nimport { getMultiRouteOptions, DoublRoute } from \"./MapServiceFunctions\";\r\nimport { getReferencePoints, CenterCoord } from \"./MapServiceFunctions\";\r\nimport { getMassPolyRouteOptions } from \"./MapServiceFunctions\";\r\nimport { getMassMultiRouteOptions } from \"./MapServiceFunctions\";\r\nimport { getMassMultiRouteInOptions } from \"./MapServiceFunctions\";\r\nimport { getPointData, getPointOptions } from \"./MapServiceFunctions\";\r\n//import { massOtladka } from \"./MapServiceFunctions\";\r\n\r\nimport { styleSetPoint, styleTypography } from \"./MainMapStyle\";\r\nimport { styleApp01, styleModalEndMapGl, styleModalMenu } from \"./MainMapStyle\";\r\n\r\nimport { Tflight } from \"./../interfaceMAP.d\";\r\nimport { Pointer } from \"./../App\";\r\n\r\nlet coordinates: Array<Array<number>> = [[]]; // массив координат\r\n//let coordinates: Array<Array<number>>; // массив координат\r\nlet coordStart: any = []; // рабочий массив коллекции входящих связей\r\nlet coordStop: any = []; // рабочий массив коллекции входящих связей\r\nlet coordStartIn: any = []; // рабочий массив коллекции исходящих связей\r\nlet coordStopIn: any = []; // рабочий массив коллекции исходящих связей\r\nlet massRoute: any = []; // рабочий массив сети связей\r\n\r\nlet dateMap: Tflight[] = [{} as Tflight];\r\nlet debugging = false;\r\nlet flagOpen = false;\r\nlet propsOpen = true;\r\nlet massrouteOpen = true;\r\nlet flagPusk = false;\r\nlet flagRoute = false;\r\nlet flagBind = false;\r\nlet flagDemo = false;\r\nlet chNewCoord = 1;\r\nlet activeRoute: any;\r\n\r\nlet homeRegion = 0;\r\nlet pointCenter: any = 0;\r\nlet pointCenterOld: any = 0;\r\nlet pointA: any = 0;\r\nlet pointAa: any = 0;\r\nlet pointB: any = 0;\r\nlet pointBb: any = 0;\r\nlet indexPoint: number = -1;\r\nlet pointAaIndex: number = -1;\r\nlet pointBbIndex: number = -1;\r\nlet soobError = \"\";\r\n\r\nconst MainMap = (props: { flag: number; ws: WebSocket; region: any }) => {\r\n  console.log(\"props:\", props.flag, props.ws, props.ws.url);\r\n  if (props.ws.url === \"wss://localhost:3000/W\") debugging = true;\r\n  //== Piece of Redux =======================================\r\n  let massdk = useSelector((state: any) => {\r\n    const { massdkReducer } = state;\r\n    return massdkReducer.massdk;\r\n  });\r\n  let massroute = useSelector((state: any) => {\r\n    const { massrouteReducer } = state;\r\n    return massrouteReducer.massroute;\r\n  });\r\n  let tt = !Object.keys(massroute).length;\r\n  if (Object.keys(massroute).length) massrouteOpen = false;\r\n  console.log(\"massroute:\", tt, massrouteOpen, massroute);\r\n\r\n  const map = useSelector((state: any) => {\r\n    const { mapReducer } = state;\r\n    return mapReducer.map;\r\n  });\r\n  if (map) {\r\n    dateMap = map.dateMap.tflight;\r\n    propsOpen = false;\r\n  }\r\n  const dispatch = useDispatch();\r\n  //=== инициализация ======================================\r\n  // if (!flagOpen && !propsOpen && !massrouteOpen) {\r\n  if (!flagOpen && !propsOpen && Object.keys(massroute).length) {\r\n    if (props.region) homeRegion = props.region;\r\n    if (!props.region && massroute.vertexes.length)\r\n      homeRegion = massroute.vertexes[0].region;\r\n    for (let i = 0; i < massroute.vertexes.length; i++) {\r\n      let masskPoint: Pointer = {\r\n        ID: -1,\r\n        coordinates: [],\r\n        nameCoordinates: \"\",\r\n        region: 0,\r\n        area: 0,\r\n        newCoordinates: 0,\r\n      };\r\n\r\n      masskPoint.ID = massroute.vertexes[i].ID;\r\n      masskPoint.coordinates = DecodingCoord(massroute.vertexes[i].dgis);\r\n      masskPoint.nameCoordinates = massroute.vertexes[i].name;\r\n      masskPoint.region = massroute.vertexes[i].region;\r\n      masskPoint.area = massroute.vertexes[i].area;\r\n      masskPoint.newCoordinates = 0;\r\n\r\n      massdk.push(masskPoint);\r\n      console.log(\r\n        \"massroute.vertexes[i].dgis:\",\r\n        DecodingCoord(massroute.vertexes[i].dgis)\r\n      );\r\n      coordinates.push(DecodingCoord(massroute.vertexes[i].dgis));\r\n    }\r\n    coordinates.splice(0, 1);\r\n    pointCenter = CenterCoord(\r\n      map.dateMap.boxPoint.point0.Y,\r\n      map.dateMap.boxPoint.point0.X,\r\n      map.dateMap.boxPoint.point1.Y,\r\n      map.dateMap.boxPoint.point1.X\r\n    );\r\n    pointCenterOld = pointCenter;\r\n    flagOpen = true;\r\n    //massroute = massOtladka; // костыль, потом убрать\r\n    dispatch(massdkCreate(massdk));\r\n    //dispatch(massrouteCreate(massroute));\r\n  }\r\n  //========================================================\r\n  const [zoom, setZoom] = React.useState<number>(9.5);\r\n  const [openSetInf, setOpenSetInf] = React.useState(false);\r\n  const [openSetEr, setOpenSetEr] = React.useState(false);\r\n  const [openSetBind, setOpenSetBind] = React.useState(false);\r\n  const [openSet, setOpenSet] = React.useState(false);\r\n  const [openSetAdress, setOpenSetAdress] = React.useState(false);\r\n\r\n  const ZeroRoute = () => {\r\n    pointA = 0;\r\n    pointB = 0;\r\n    pointAa = 0;\r\n    pointBb = 0;\r\n    pointAaIndex = -1;\r\n    pointBbIndex = -1;\r\n    coordStart = [];\r\n    coordStop = [];\r\n    coordStartIn = [];\r\n    coordStopIn = [];\r\n    flagRoute = false;\r\n    flagBind = false;\r\n    pointCenter = pointCenterOld;\r\n    setSize(window.innerWidth + Math.random());\r\n  };\r\n\r\n  const MakeRecordMassRoute = () => {\r\n    // let flDubl = false;\r\n    let pointAcod = CodingCoord(pointA);\r\n    let pointBcod = CodingCoord(pointB);\r\n    if (DoublRoute(massroute, pointA, pointB)) {\r\n      soobError = \"Не сохранено - дубликатная связь\";\r\n      setOpenSetEr(true);\r\n    } else {\r\n      massroute.ways.push(\r\n        RecordMassRoute(Number(homeRegion), pointAcod, pointBcod, activeRoute)\r\n      );\r\n    }\r\n    ZeroRoute();\r\n  };\r\n\r\n  const PressMenuButton = (mode: number) => {\r\n    switch (mode) {\r\n      case 3: // режим включения Demo сети связей\r\n        massRoute = massroute.ways;\r\n        flagDemo = true;\r\n        setSize(window.innerWidth + Math.random());\r\n        break;\r\n      case 6: // режим отмены Demo сети связей\r\n        massRoute = [];\r\n        flagDemo = false;\r\n        setSize(window.innerWidth + Math.random());\r\n        break;\r\n      case 12: // реверс маршрута\r\n        let pa = pointA;\r\n        pointA = pointB;\r\n        pointB = pa;\r\n        pa = pointAa;\r\n        pointAa = pointBb;\r\n        pointBb = pa;\r\n        pa = pointAaIndex;\r\n        pointAaIndex = pointBbIndex;\r\n        pointBbIndex = pa;\r\n        setSize(window.innerWidth + Math.random());\r\n        break;\r\n      case 21: // сохранение маршрута\r\n        MakeRecordMassRoute();\r\n        flagPusk = false;\r\n        break;\r\n      case 33: // привязка направлений\r\n        flagBind = true;\r\n        setOpenSetBind(true);\r\n        break;\r\n      case 69: // инфа о маршруте\r\n        if (activeRoute) setOpenSetInf(true);\r\n        break;\r\n      case 77: // удаление маршрута\r\n        ZeroRoute();\r\n    }\r\n  };\r\n\r\n  const mapState = {\r\n    center: pointCenter,\r\n    zoom, //autoFitToViewport: true, behaviors: [\"default\", \"scrollZoom\"], controls: [],\r\n    yandexMapDisablePoiInteractivity: true,\r\n  };\r\n\r\n  const MapGl = (props: { ws: WebSocket; pointa: any; pointb: any }) => {\r\n    const mapp = React.useRef<any>(null);\r\n    let pointAA = props.pointa;\r\n    let pointBB = props.pointb;\r\n\r\n    const MakeRoute = () => {\r\n      pointA = pointAa; // === Запуск создания связи ===\r\n      pointB = pointBb;\r\n      flagRoute = true;\r\n      setSize(window.innerWidth + Math.random());\r\n    };\r\n\r\n    const addRoute = (ymaps: any) => {\r\n      const multiRoute = new ymaps.multiRouter.MultiRoute(\r\n        getReferencePoints(pointAA, pointBB),\r\n        getMultiRouteOptions()\r\n      );\r\n      let massPolyRoute: any = []; // cеть связей\r\n      for (let i = 0; i < massRoute.length; i++) {\r\n        massPolyRoute[i] = new ymaps.Polyline(\r\n          [\r\n            DecodingCoord(massRoute[i].starts),\r\n            DecodingCoord(massRoute[i].stops),\r\n          ],\r\n          { balloonContent: \"Ломаная линия\" },\r\n          getMassPolyRouteOptions()\r\n        );\r\n        mapp.current.geoObjects.add(massPolyRoute[i]);\r\n      }\r\n      let massMultiRoute: any = []; // исходящие связи\r\n      for (let i = 0; i < coordStart.length; i++) {\r\n        massMultiRoute[i] = new ymaps.multiRouter.MultiRoute(\r\n          getReferencePoints(coordStart[i], coordStop[i]),\r\n          getMassMultiRouteOptions()\r\n        );\r\n        mapp.current.geoObjects.add(massMultiRoute[i]);\r\n      }\r\n      let massMultiRouteIn: any = []; // входящие связи\r\n      for (let i = 0; i < coordStartIn.length; i++) {\r\n        massMultiRouteIn[i] = new ymaps.multiRouter.MultiRoute(\r\n          getReferencePoints(coordStartIn[i], coordStopIn[i]),\r\n          getMassMultiRouteInOptions()\r\n        );\r\n        mapp.current.geoObjects.add(massMultiRouteIn[i]);\r\n      }\r\n      mapp.current.geoObjects.add(multiRoute); // основная связь\r\n      multiRoute.model.events.add(\"requestsuccess\", function () {\r\n        activeRoute = multiRoute.getActiveRoute();\r\n      });\r\n    };\r\n\r\n    const MakeСollectionRoute = () => {\r\n      for (let i = 0; i < massroute.ways.length; i++) {\r\n        if (massroute.ways[i].starts === CodingCoord(pointAa)) {\r\n          coordStop.push(DecodingCoord(massroute.ways[i].stops)); // исходящие связи\r\n          coordStart.push(pointAa);\r\n        }\r\n        if (massroute.ways[i].stops === CodingCoord(pointAa)) {\r\n          coordStartIn.push(DecodingCoord(massroute.ways[i].starts)); // входящие связи\r\n          coordStopIn.push(pointAa);\r\n        }\r\n      }\r\n    };\r\n\r\n    const OnPlacemarkClickPoint = (index: number) => {\r\n      pointCenter = pointCenterOld;\r\n      if (pointAa === 0) {\r\n        pointAaIndex = index; // начальная точка\r\n        pointAa = [massdk[index].coordinates[0], massdk[index].coordinates[1]];\r\n        MakeСollectionRoute();\r\n        flagPusk = true;\r\n        setSize(window.innerWidth + Math.random());\r\n      } else {\r\n        if (pointBb === 0) {\r\n          if (pointAaIndex === index) {\r\n            soobError = \"Начальная и конечная точки совпадают\";\r\n            setOpenSetEr(true);\r\n          } else {\r\n            pointBbIndex = index; // конечная точка\r\n            pointBb = [\r\n              massdk[index].coordinates[0],\r\n              massdk[index].coordinates[1],\r\n            ];\r\n            MakeRoute();\r\n            if (DoublRoute(massroute, pointAa, pointBb)) {\r\n              soobError = \"Дубликатная связь\";\r\n              setOpenSetEr(true);\r\n              //ZeroRoute();\r\n            }\r\n          }\r\n        } else {\r\n          indexPoint = index;\r\n          setOpenSet(true); // в меню работы с точками\r\n        }\r\n      }\r\n    };\r\n\r\n    const ModalPressBalloon = () => {\r\n      const [openSetErBall, setOpenSetErBall] = React.useState(false);\r\n      let pointRoute: any = 0;\r\n\r\n      if (indexPoint >= 0 && indexPoint < massdk.length) {\r\n        pointRoute = [\r\n          massdk[indexPoint].coordinates[0],\r\n          massdk[indexPoint].coordinates[1],\r\n        ];\r\n      }\r\n\r\n      const handleClose = (param: number) => {\r\n        switch (param) {\r\n          case 1: // Начальная точка\r\n            if (pointBbIndex === indexPoint) {\r\n              soobError = \"Начальная и конечная точки совпадают\";\r\n              setOpenSetErBall(true);\r\n            } else {\r\n              pointAaIndex = indexPoint;\r\n              pointAa = pointRoute;\r\n              MakeRoute();\r\n            }\r\n            break;\r\n          case 2: // Конечная точка\r\n            if (pointAaIndex === indexPoint) {\r\n              soobError = \"Начальная и конечная точки совпадают\";\r\n              setOpenSetErBall(true);\r\n            } else {\r\n              pointBbIndex = indexPoint;\r\n              pointBb = pointRoute;\r\n              MakeRoute();\r\n            }\r\n            break;\r\n          case 3: // Удаление точки\r\n            if (pointAaIndex === indexPoint || pointBbIndex === indexPoint) {\r\n              soobError = \"Начальную и конечную точки удалять нельзя\";\r\n              setOpenSetErBall(true);\r\n            } else {\r\n              let massRouteRab: any = []; // удаление из массива сети связей\r\n              let coordPoint: any = CodingCoord(coordinates[indexPoint]);\r\n              for (let i = 0; i < massroute.length; i++) {\r\n                if (\r\n                  coordPoint !== massroute.ways[i].start &&\r\n                  coordPoint !== massroute.ways[i].stop\r\n                )\r\n                  massRouteRab.push(massroute.ways[i]);\r\n              }\r\n              massroute.ways.splice(0, massroute.ways.length); // massroute = [];\r\n              massroute.ways = massRouteRab;\r\n              massRoute = massroute.ways;\r\n              dispatch(massrouteCreate(massroute));\r\n              coordStart = []; // удаление колекции связей\r\n              coordStop = [];\r\n              coordStartIn = [];\r\n              coordStopIn = [];\r\n              massdk.splice(indexPoint, 1); // удаление самой точки\r\n              coordinates.splice(indexPoint, 1);\r\n              setOpenSet(false);\r\n              pointCenter = pointCenterOld;\r\n              setSize(window.innerWidth + Math.random());\r\n            }\r\n            break;\r\n          case 4: // Редактирование адреса\r\n            setOpenSetAdress(true);\r\n        }\r\n      };\r\n\r\n      const StrokaPressBalloon = (soob: string, mode: number) => {\r\n        return (\r\n          <Button sx={styleModalMenu} onClick={() => handleClose(mode)}>\r\n            <b>{soob}</b>\r\n          </Button>\r\n        );\r\n      };\r\n\r\n      return (\r\n        <Modal open={openSet} onClose={() => setOpenSet(false)} hideBackdrop>\r\n          <Box sx={styleSetPoint}>\r\n            <Button sx={styleModalEndMapGl} onClick={() => setOpenSet(false)}>\r\n              <b>&#10006;</b>\r\n            </Button>\r\n            <Box sx={{ marginTop: 2, textAlign: \"center\" }}>\r\n              {StrokaPressBalloon(\"Удаление точки\", 3)}\r\n              {StrokaPressBalloon(\"Редактирование адреса\", 4)}\r\n            </Box>\r\n            <Typography variant=\"h6\" sx={styleTypography}>\r\n              Перестроение связи:\r\n            </Typography>\r\n            <Box sx={{ textAlign: \"center\" }}>\r\n              {StrokaPressBalloon(\"Начальная точка\", 1)}\r\n              {StrokaPressBalloon(\"Конечная точка\", 2)}\r\n            </Box>\r\n            {openSetAdress && (\r\n              <MapInputAdress iPoint={indexPoint} setOpen={setOpenSetAdress} />\r\n            )}\r\n            {openSetErBall && (\r\n              <MapPointDataError sErr={soobError} setOpen={setOpenSetErBall} />\r\n            )}\r\n          </Box>\r\n        </Modal>\r\n      );\r\n    };\r\n\r\n    const SendSocketNewPoint = (codCoord: string) => {\r\n      const handleSendOpen = () => {\r\n        if (!debugging) {\r\n          if (props.ws.readyState === WebSocket.OPEN) {\r\n            props.ws.send(\r\n              JSON.stringify({\r\n                type: \"createPoint\",\r\n                data: {\r\n                  position: codCoord,\r\n                  name: \"Новая точка \" + String(chNewCoord - 1),\r\n                },\r\n              })\r\n            );\r\n          } else {\r\n            setTimeout(() => {\r\n              handleSendOpen();\r\n            }, 1000);\r\n          }\r\n        }\r\n      };\r\n      handleSendOpen();\r\n    };\r\n\r\n    console.log(\"coordinates:\", coordinates[0].length);\r\n\r\n    return (\r\n      <YMaps\r\n        query={{\r\n          apikey: \"65162f5f-2d15-41d1-a881-6c1acf34cfa1\", // \"b9f13766-acdb-46cd-a2a1-fc790dd80cec\",\r\n          lang: \"ru_RU\",\r\n        }}\r\n      >\r\n        <Map\r\n          modules={[\"multiRouter.MultiRoute\", \"Polyline\"]}\r\n          state={mapState}\r\n          instanceRef={(ref) => {\r\n            if (ref) {\r\n              mapp.current = ref;\r\n              mapp.current.events.add(\"contextmenu\", function (e: any) {\r\n                // нажата правая кнопка мыши (создание новой точки)\r\n                if (mapp.current.hint) {\r\n                  massdk.push(\r\n                    MapNewPoint(homeRegion, e.get(\"coords\"), chNewCoord++)\r\n                  );\r\n                  coordinates.push(e.get(\"coords\"));\r\n                  SendSocketNewPoint(CodingCoord(e.get(\"coords\")));\r\n                  setSize(window.innerWidth + Math.random());\r\n                }\r\n              });\r\n              mapp.current.events.add(\"mousedown\", function (e: any) {\r\n                // нажата левая/правая кнопка мыши 0, 1 или 2 в зависимости от того, какая кнопка мыши нажата (В IE значение может быть от 0 до 7).\r\n                if (e.get(\"domEvent\").originalEvent.button === 0) {\r\n                  pointCenterOld = pointCenter;\r\n                  pointCenter = e.get(\"coords\");\r\n                }\r\n              });\r\n              mapp.current.events.add([\"boundschange\"], function () {\r\n                setZoom(mapp.current.getZoom()); // покрутили колёсико мыши\r\n              });\r\n            }\r\n          }}\r\n          onLoad={addRoute}\r\n          width={\"99.8%\"}\r\n          height={\"97%\"}\r\n        >\r\n          {coordinates[0].length > 0 &&\r\n            coordinates.map((coordinate, idx) => (\r\n              <Placemark\r\n                key={idx}\r\n                geometry={coordinate}\r\n                properties={getPointData(\r\n                  idx,\r\n                  pointAaIndex,\r\n                  pointBbIndex,\r\n                  massdk\r\n                )}\r\n                options={getPointOptions(\r\n                  idx,\r\n                  pointAaIndex,\r\n                  pointBbIndex,\r\n                  massdk\r\n                )}\r\n                modules={[\"geoObject.addon.balloon\", \"geoObject.addon.hint\"]}\r\n                onClick={() => OnPlacemarkClickPoint(idx)}\r\n              />\r\n            ))}\r\n          <FullscreenControl />\r\n          <GeolocationControl options={{ float: \"left\" }} />\r\n          <RulerControl options={{ float: \"right\" }} />\r\n          <SearchControl\r\n            options={{\r\n              float: \"left\",\r\n              provider: \"yandex#search\",\r\n              size: \"large\",\r\n            }}\r\n          />\r\n          <TrafficControl options={{ float: \"right\" }} />\r\n          <TypeSelector options={{ float: \"right\" }} />\r\n          <ZoomControl options={{ float: \"right\" }} />\r\n          {/* служебные компоненты */}\r\n          <ModalPressBalloon />\r\n          {openSetEr && (\r\n            <MapPointDataError sErr={soobError} setOpen={setOpenSetEr} />\r\n          )}\r\n          {openSetInf && (\r\n            <MapRouteInfo\r\n              activeRoute={activeRoute}\r\n              name1={massdk[pointAaIndex].nameCoordinates}\r\n              name2={massdk[pointBbIndex].nameCoordinates}\r\n              setOpen={setOpenSetInf}\r\n            />\r\n          )}\r\n          {openSetBind && <MapRouteBind setOpen={setOpenSetBind} />}\r\n        </Map>\r\n      </YMaps>\r\n    );\r\n  };\r\n\r\n  //отслеживание изменения размера экрана - костыль, делает ререндер\r\n  const [size, setSize] = React.useState(0);\r\n  React.useLayoutEffect(() => {\r\n    function updateSize() {\r\n      setSize(window.innerWidth);\r\n    }\r\n    window.addEventListener(\"resize\", updateSize);\r\n    updateSize();\r\n    return () => window.removeEventListener(\"resize\", updateSize);\r\n  }, []);\r\n\r\n  const StrokaMenuGlob = (soob: string, mode: number) => {\r\n    return (\r\n      <Button sx={styleApp01} onClick={() => PressMenuButton(mode)}>\r\n        <b>{soob}</b>\r\n      </Button>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <Grid container sx={{ height: \"99.5vh\" }}>\r\n      {flagPusk && !flagBind && <>{StrokaMenuGlob(\"Отмена назначений\", 77)}</>}\r\n      {flagPusk && flagRoute && !flagBind && (\r\n        <>\r\n          {StrokaMenuGlob(\"Привязка направлен\", 33)}\r\n          {StrokaMenuGlob(\"Реверс связи\", 12)}\r\n          {StrokaMenuGlob(\"Информ о связи\", 69)}\r\n        </>\r\n      )}\r\n      {flagPusk && flagRoute && flagBind && (\r\n        <>\r\n          {StrokaMenuGlob(\"Сохранить связь\", 21)}\r\n          {StrokaMenuGlob(\"Отменить связь\", 77)}\r\n          {StrokaMenuGlob(\"Информ о связи\", 69)}\r\n        </>\r\n      )}\r\n      {!flagDemo && <>{StrokaMenuGlob(\"Demo сети\", 3)}</>}\r\n      {flagDemo && <>{StrokaMenuGlob(\"Конец Demo\", 6)}</>}\r\n      {!propsOpen && <MapGl ws={props.ws} pointa={pointA} pointb={pointB} />}\r\n    </Grid>\r\n  );\r\n};\r\n\r\nexport default MainMap;\r\n","import React from \"react\";\r\nimport {\r\n  useDispatch,\r\n  //useSelector\r\n} from \"react-redux\";\r\nimport {\r\n  mapCreate,\r\n  massrouteCreate,\r\n  //commCreate,\r\n  // massdkCreate\r\n} from \"./redux/actions\";\r\n\r\nimport Grid from \"@mui/material/Grid\";\r\n\r\nimport MainMap from \"./components/MainMapGl\";\r\n//import { CenterCoord } from \"./components/MapServiceFunctions\";\r\n\r\n//import { DateMAP } from './interfaceMAP.d';\r\nimport { DateRoute } from './interfaceRoute.d';\r\n//import { Tflight } from \"./interfaceMAP.d\";\r\nimport { dataMap } from \"./otladkaMaps\";\r\nimport { dataRoute } from \"./otladkaRoutes\";\r\n\r\nexport let dateMapGl: any;\r\nexport let dateRouteGl: any;\r\n//export let dateRouteGl: dataRoute;\r\n\r\nexport interface Pointer {\r\n  ID: number;\r\n  coordinates: Array<number>;\r\n  nameCoordinates: string;\r\n  region: number;\r\n  area: number;\r\n  newCoordinates: number;\r\n}\r\nexport let massDk: Pointer[] = [];\r\n\r\nexport interface Router {\r\n  region: number;\r\n  sourceArea: number;\r\n  sourceID: number;\r\n  targetArea: number;\r\n  targetID: number;\r\n  lsource: number;\r\n  ltarget: number;\r\n  starts: string;\r\n  stops: string;\r\n  length: number;\r\n  time: number;\r\n}\r\nexport let massRoute: Router[] = [];\r\n\r\nlet flagOpen = true;\r\nlet flagRoute = 0;\r\n\r\nlet flagOpenWS = true;\r\n//let flagWS = true;\r\nlet WS: any = null;\r\nlet homeRegion: any = \"\";\r\n\r\nconst App = () => {\r\n  //== Piece of Redux ======================================\r\n  // const comm = useSelector((state: any) => {\r\n  //   const { commReducer } = state;\r\n  //   return commReducer.comm;\r\n  // });\r\n  // //console.log('comm_App:', comm);\r\n\r\n  // const map = useSelector((state: any) => {\r\n  //   const { mapReducer } = state;\r\n  //   return mapReducer.map;\r\n  // });\r\n  //console.log(\"map_App:\", map);\r\n\r\n  // const massdk = useSelector((state: any) => {\r\n  //   const { massdkReducer } = state;\r\n  //   return massdkReducer.massdk;\r\n  // });\r\n  //console.log(\"massdk_App:\", massdk);\r\n\r\n  const dispatch = useDispatch();\r\n  //========================================================\r\n\r\n  //const host = \"wss://192.168.115.25/mapW\";\r\n  //const host = \"wss://192.168.115.25/user/andrey_omsk/graphManageW\";\r\n  const host =\r\n    \"wss://\" +\r\n    window.location.host +\r\n    window.location.pathname +\r\n    \"W\" +\r\n    window.location.search;\r\n\r\n  if (flagOpenWS) {\r\n    WS = new WebSocket(host);\r\n    flagOpenWS = false;\r\n    let pageUrl = new URL(window.location.href);\r\n    homeRegion = pageUrl.searchParams.get(\"Region\");\r\n    console.log(\"WS:\", WS);\r\n  }\r\n\r\n  React.useEffect(() => {\r\n    WS.onopen = function (event: any) {\r\n      console.log(\"WS.current.onopen:\", event);\r\n    };\r\n\r\n    WS.onclose = function (event: any) {\r\n      console.log(\"WS.current.onclose:\", event);\r\n    };\r\n\r\n    WS.onerror = function (event: any) {\r\n      console.log(\"WS.current.onerror:\", event);\r\n    };\r\n\r\n    WS.onmessage = function (event: any) {\r\n      let allData = JSON.parse(event.data);\r\n      let data = allData.data;\r\n      console.log(\"пришло:\", allData.type, data);\r\n      switch (allData.type) {\r\n        case \"mapInfo\":\r\n          console.log(\"mapInfo:\", data);\r\n          dateMapGl = data;\r\n          dispatch(mapCreate(dateMapGl));\r\n          break;\r\n        case \"graphInfo\":\r\n          console.log(\"graphInfo:\", data);\r\n          dateRouteGl = data;\r\n          flagRoute = 1; // успешное прочтение\r\n          dispatch(massrouteCreate(dateRouteGl));\r\n          break;\r\n        default:\r\n          console.log(\"data_default:\", data);\r\n      }\r\n    };\r\n  }, [WS, dispatch]);\r\n\r\n  //для отладки\r\n\r\n  // if (flagOpen) {\r\n  //   dateMapGl = dataMap;\r\n  //   flagRoute = 1;\r\n  //   dispatch(mapCreate(dateMapGl));\r\n  //   dateRouteGl = dataRoute.data;\r\n  //   flagOpen = false;\r\n  //   dispatch(massrouteCreate(dateRouteGl));\r\n  // }\r\n\r\n  //отслеживание изменения размера экрана - костыль, делает ререндер\r\n  // const [size, setSize] = React.useState(0);\r\n  // React.useLayoutEffect(() => {\r\n  //   function updateSize() {\r\n  //     setSize(window.innerWidth);\r\n  //   }\r\n  //   window.addEventListener(\"resize\", updateSize);\r\n  //   updateSize();\r\n  //   return () => window.removeEventListener(\"resize\", updateSize);\r\n  // }, []);\r\n\r\n  // if (flagRoute === 1) {\r\n  //   console.log(\"dateRouteGl:\", dateRouteGl);\r\n  //   // проверка/удаление дубликатных связей\r\n  //   let dateRouteRab: any = [];\r\n  //   let flagDubl = false;\r\n  //   for (let i = 0; i < dateRouteGl.ways.length; i++) {\r\n  //     for (let j = 0; j < dateRouteRab.length; j++) {\r\n  //       if (\r\n  //         dateRouteRab[j].starts === dateRouteGl.ways[i].starts &&\r\n  //         dateRouteRab[j].stops === dateRouteGl.ways[i].stops\r\n  //       )\r\n  //         flagDubl = true;\r\n  //     }\r\n  //     if (!flagDubl) dateRouteRab.push(dateRouteGl.ways[i]);\r\n  //     flagDubl = false;\r\n  //   }\r\n  //   dateRouteGl.ways.splice(0, dateRouteGl.ways.length);\r\n  //   dateRouteGl.ways = dateRouteRab;\r\n  //   dispatch(massrouteCreate(dateRouteGl));\r\n  //   flagRoute = 2;\r\n  //   //setSize(window.innerWidth + Math.random());\r\n  // }\r\n  console.log(\"dateRouteGl:\", dateRouteGl);\r\n  return (\r\n    <Grid container sx={{ height: \"100vh\", width: \"100%\", bgcolor: \"#F1F5FB\" }}>\r\n      <Grid item xs>\r\n      <MainMap flag={flagRoute} ws={WS} region={homeRegion} />\r\n        {/* {setTimeout(() => {<MainMap ws={WS} region={homeRegion} />}, 10000)  } */}\r\n        \r\n      </Grid>\r\n    </Grid>\r\n  );\r\n};\r\n\r\nexport default App;\r\n","export const styleApp01 = {\r\n  fontSize: 14,\r\n  marginRight: 0.5,\r\n  width: '19%',\r\n  maxHeight: '21px',\r\n  minHeight: '21px',\r\n  //backgroundColor: '#F1F3F4',\r\n  backgroundColor: '#E6F5D6',\r\n  color: 'black',\r\n  textTransform: 'unset !important',\r\n};\r\n\r\nexport const styleTypography = {\r\n  textAlign: \"center\", \r\n  color: \"#5B1080\"\r\n};\r\n\r\n\r\nexport const styleModalEnd = {\r\n  position: 'absolute',\r\n  top: '0%',\r\n  left: 'auto',\r\n  right: '-6%',\r\n  height: '21px',\r\n  width: '6%',\r\n  color: 'black',\r\n};\r\n\r\nexport const styleSetInf = {\r\n  position: 'absolute',\r\n  marginTop: '15vh',\r\n  marginLeft: '24vh',\r\n  width: 340,\r\n  bgcolor: 'background.paper',\r\n  border: '3px solid #000',\r\n  borderColor: 'primary.main',\r\n  borderRadius: 2,\r\n  boxShadow: 24,\r\n  p: 1.5,\r\n};\r\n\r\n//=== MapGl =====================================================\r\n\r\nexport const styleSetPoint = {\r\n  position: 'absolute',\r\n  marginTop: '15vh',\r\n  marginLeft: '24vh',\r\n  width: 250,\r\n  bgcolor: 'background.paper',\r\n  border: '3px solid #000',\r\n  borderColor: 'primary.main',\r\n  borderRadius: 2,\r\n  boxShadow: 24,\r\n  p: 2,\r\n};\r\n\r\nexport const styleModalEndMapGl = {\r\n  position: 'absolute',\r\n  top: '0%',\r\n  left: 'auto',\r\n  right: '-9%',\r\n  maxHeight: '21px',\r\n  minHeight: '21px',\r\n  width: '6%',\r\n  color: 'black',\r\n};\r\n\r\nexport const styleModalMenu = {\r\n  fontSize: 17,\r\n  maxHeight: '21px',\r\n  minHeight: '21px',\r\n  //backgroundColor: '#F1F3F4',\r\n  backgroundColor: '#E6F5D6',\r\n  color: 'black',\r\n  marginRight: 1,\r\n  marginBottom: 2,\r\n  textTransform: 'unset !important',\r\n  textAlign: 'center',\r\n};\r\n//=== InputAdress =====================================================\r\nexport const styleSet = {\r\n  width: '230px',\r\n  maxHeight: '4px',\r\n  minHeight: '4px',\r\n  bgcolor: '#FAFAFA',\r\n  boxShadow: 24,\r\n  textAlign: 'center',\r\n  p: 1.5,\r\n};\r\n\r\nexport const styleInpKnop = {\r\n  fontSize: 13.3,\r\n  color: 'black',\r\n  maxHeight: '27px',\r\n  minHeight: '27px',\r\n  maxWidth: '62px',\r\n  minWidth: '62px',\r\n  backgroundColor: '#FFDB4D',\r\n  textTransform: 'unset !important',\r\n};\r\n\r\nexport const styleSetAdress = {\r\n  width: '319px',\r\n  height: '30px',\r\n  marginTop: '9vh',\r\n  marginLeft: '48px',\r\n};\r\n\r\nexport const styleBoxForm = {\r\n  '& > :not(style)': {\r\n    marginTop: '-9px',\r\n    marginLeft: '-12px',\r\n    width: '255px',\r\n  },\r\n};","import * as React from \"react\";\r\n\r\nimport Box from \"@mui/material/Box\";\r\nimport Button from \"@mui/material/Button\";\r\nimport Modal from \"@mui/material/Modal\";\r\n\r\nimport { styleModalEnd, styleSetInf } from \"./../MainMapStyle\";\r\n\r\nconst MapRouteInfo = (props: {\r\n  activeRoute: any;\r\n  name1: string;\r\n  name2: string;\r\n  setOpen: any;\r\n}) => {\r\n  const [openSetInf, setOpenSetInf] = React.useState(true);\r\n\r\n  const handleCloseSetEndInf = () => {\r\n    props.setOpen(false);\r\n    setOpenSetInf(false);\r\n  };\r\n  let dlRoute1 = 0;\r\n  let tmRoute1 = \"\";\r\n  if (props.activeRoute) {\r\n    dlRoute1 = Math.round(props.activeRoute.properties.get(\"distance\").value);\r\n    let tm = props.activeRoute.properties.get(\"duration\").text;\r\n    tmRoute1 =\r\n      tm.substring(0, tm.length - 1) +\r\n      \" (\" +\r\n      Math.round(props.activeRoute.properties.get(\"duration\").value) +\r\n      \" сек)\";\r\n    console.log(\"1111\", props.activeRoute.properties.get(\"duration\"));\r\n  }\r\n  return (\r\n    <Modal open={openSetInf} onClose={handleCloseSetEndInf} hideBackdrop>\r\n      <Box sx={styleSetInf}>\r\n        <Button sx={styleModalEnd} onClick={handleCloseSetEndInf}>\r\n          <b>&#10006;</b>\r\n        </Button>\r\n        <Box>\r\n          <b>Начальная точка связи:</b>\r\n          <br />\r\n          {props.name1}\r\n          <br />\r\n          <b>Конечная точка связи:</b>\r\n          <br />\r\n          {props.name2}\r\n          <br />\r\n          <b>Длина связи: </b>\r\n          {dlRoute1} м<br />\r\n          <b>Время прохождения: </b>\r\n          {tmRoute1}\r\n          <br />\r\n        </Box>\r\n        {props.activeRoute && props.activeRoute.properties.get(\"blocked\") && (\r\n          <Box>Имеются участки с перекрытыми дорогами</Box>\r\n        )}\r\n      </Box>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default MapRouteInfo;\r\n","import * as React from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\n\r\nimport Grid from \"@mui/material/Grid\";\r\nimport Box from \"@mui/material/Box\";\r\nimport Button from \"@mui/material/Button\";\r\nimport Modal from \"@mui/material/Modal\";\r\nimport TextField from \"@mui/material/TextField\";\r\n\r\nimport { styleSet, styleInpKnop, styleSetAdress } from \"./../MainMapStyle\";\r\nimport { styleBoxForm } from \"./../MainMapStyle\";\r\n\r\nconst MapInputAdress = (props: { iPoint: number; setOpen: any }) => {\r\n  //== Piece of Redux ======================================\r\n  let massdk = useSelector((state: any) => {\r\n    const { massdkReducer } = state;\r\n    return massdkReducer.massdk;\r\n  });\r\n  //========================================================\r\n  const [openSetAdress, setOpenSetAdress] = React.useState(true);\r\n \r\n  const [valuen, setValuen] = React.useState(\r\n    massdk[props.iPoint].nameCoordinates\r\n  );\r\n\r\n  const handleKey = (event: any) => {\r\n    if (event.key === \"Enter\") event.preventDefault();\r\n  };\r\n\r\n  const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    setValuen(event.target.value);\r\n  };\r\n\r\n  const handleCloseSetAdr = () => {\r\n    massdk[props.iPoint].nameCoordinates = valuen;\r\n    setOpenSetAdress(false);\r\n    props.setOpen(false);\r\n  };\r\n\r\n  return (\r\n    <Box>\r\n      <Modal open={openSetAdress} onClose={handleCloseSetAdr} hideBackdrop>\r\n        <Grid item container sx={styleSetAdress}>\r\n          <Grid item xs={9.5} sx={{ border: 0 }}>\r\n            <Box sx={styleSet}>\r\n              <Box\r\n                component=\"form\"\r\n                sx={styleBoxForm}\r\n                noValidate\r\n                autoComplete=\"off\"\r\n              >\r\n                <TextField\r\n                  size=\"small\"\r\n                  onKeyPress={handleKey} //отключение Enter\r\n                  inputProps={{ style: { fontSize: 13.3 } }}\r\n                  value={valuen}\r\n                  onChange={handleChange}\r\n                  variant=\"standard\"\r\n                />\r\n              </Box>\r\n            </Box>\r\n          </Grid>\r\n          <Grid item xs sx={{ border: 0 }}>\r\n            <Box>\r\n              <Button\r\n                sx={styleInpKnop}\r\n                variant=\"contained\"\r\n                onClick={handleCloseSetAdr}\r\n              >\r\n                Ввод\r\n              </Button>\r\n            </Box>\r\n          </Grid>\r\n        </Grid>\r\n      </Modal>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default MapInputAdress;\r\n","import * as React from \"react\";\r\n\r\nimport Box from \"@mui/material/Box\";\r\nimport Button from \"@mui/material/Button\";\r\nimport Modal from \"@mui/material/Modal\";\r\nimport Typography from \"@mui/material/Typography\";\r\n\r\nimport { styleModalEnd, styleSetInf } from \"./../MainMapStyle\";\r\n\r\nconst MapPointDataError = (props: { sErr: string; setOpen: any }) => {\r\n  const [openSetEr, setOpenSetEr] = React.useState(true);\r\n  const handleCloseSetEr = (event: any, reason: string) => {\r\n    if (reason !== \"backdropClick\") setOpenSetEr(false);\r\n  };\r\n\r\n  const handleCloseSetEndEr = () => {\r\n    props.setOpen(false);\r\n    setOpenSetEr(false);\r\n  };\r\n\r\n  return (\r\n    <Modal open={openSetEr} onClose={handleCloseSetEr} hideBackdrop>\r\n      <Box sx={styleSetInf}>\r\n        <Button sx={styleModalEnd} onClick={handleCloseSetEndEr}>\r\n          <b>&#10006;</b>\r\n        </Button>\r\n        <Typography variant=\"h6\" sx={{ textAlign: \"center\", color: \"red\" }}>\r\n          {props.sErr}\r\n        </Typography>\r\n      </Box>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default MapPointDataError;\r\n","import * as React from \"react\";\r\n\r\nimport Box from \"@mui/material/Box\";\r\nimport Button from \"@mui/material/Button\";\r\nimport Modal from \"@mui/material/Modal\";\r\n\r\nimport { styleModalEnd, styleSetInf } from \"./../MainMapStyle\";\r\n\r\nconst MapRouteBind = (props: { setOpen: any }) => {\r\n  const [openSetBind, setOpenSetBind] = React.useState(true);\r\n\r\n  const handleCloseSetEndBind = () => {\r\n    props.setOpen(false);\r\n    setOpenSetBind(false);\r\n  };\r\n\r\n  return (\r\n    <Modal open={openSetBind} onClose={handleCloseSetEndBind} hideBackdrop>\r\n      <Box sx={styleSetInf}>\r\n        <Button sx={styleModalEnd} onClick={handleCloseSetEndBind}>\r\n          <b>&#10006;</b>\r\n        </Button>\r\n        <Box sx={{ textAlign: \"center\" }}>\r\n          <br />\r\n          <br />\r\n          <b>Здесь будет привязка направления</b>\r\n          <br /> <br />\r\n          <br />\r\n        </Box>\r\n      </Box>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default MapRouteBind;\r\n","//import * as React from \"react\";\r\n\r\nimport { Pointer, Router } from \"./../App\";\r\n\r\nexport const MapNewPoint = (homeRegion: number, coords: any, chNewCoord: number) => {\r\n  let masskPoint: Pointer = {\r\n    ID: 0,\r\n    coordinates: [],\r\n    nameCoordinates: \"\",\r\n    region: 0,\r\n    area: 0,\r\n    newCoordinates: 0,\r\n  };\r\n\r\n  masskPoint.ID = 0;\r\n  masskPoint.coordinates = coords;\r\n  masskPoint.nameCoordinates = \"Новая точка \" + String(chNewCoord);\r\n  masskPoint.region = homeRegion;\r\n  masskPoint.area = 0;\r\n  masskPoint.newCoordinates = 1;\r\n  return masskPoint;\r\n};\r\n\r\nexport const RecordMassRoute = (\r\n  homeRegion: number,\r\n  pointAcod: string,\r\n  pointBcod: string,\r\n  activeRoute: any\r\n) => {\r\n  let masskRoute: Router = {\r\n    region: 0,\r\n    sourceArea: 0,\r\n    sourceID: 0,\r\n    targetArea: 0,\r\n    targetID: 0,\r\n    lsource: 0,\r\n    ltarget: 0,\r\n    starts: \"\",\r\n    stops: \"\",\r\n    length: 0,\r\n    time: 0,\r\n  };\r\n  masskRoute.region = homeRegion;\r\n  masskRoute.starts = pointAcod;\r\n  masskRoute.stops = pointBcod;\r\n  if (activeRoute) {\r\n    masskRoute.time = Math.round(activeRoute.properties.get(\"duration\").value);\r\n    masskRoute.length = Math.round(\r\n      activeRoute.properties.get(\"distance\").value\r\n    );\r\n  }\r\n  return masskRoute;\r\n};\r\n\r\nexport const DecodingCoord = (coord: string) => {\r\n  return coord.split(\",\").map(Number);\r\n};\r\n\r\nexport const CodingCoord = (coord: Array<number>) => {\r\n  return String(coord[0]) + \",\" + String(coord[1]);\r\n};\r\n\r\nexport const DoublRoute = (massroute: any, pointA: any, pointB: any) => {\r\n  let flDubl = false;\r\n  let pointAcod = CodingCoord(pointA);\r\n  let pointBcod = CodingCoord(pointB);\r\n  for (let i = 0; i < massroute.length; i++) {\r\n    if (\r\n      massroute[i].starts === pointAcod &&\r\n      massroute[i].stops === pointBcod\r\n    )\r\n      flDubl = true;\r\n  }\r\n  return flDubl;\r\n};\r\n\r\nexport const CenterCoord = (aY: number, aX: number, bY: number, bX: number) => {\r\n  let coord0 = (aY - bY) / 2 + bY;\r\n  if (aY < bY) coord0 = (bY - aY) / 2 + aY;\r\n  let coord1 = (aX - bX) / 2 + bX;\r\n  if (aX < bX) coord1 = (bX - aX) / 2 + aX;\r\n  return [coord0, coord1];\r\n};\r\n\r\n//=== Placemark =====================================\r\n\r\nexport const getPointData = (\r\n  index: number,\r\n  pointAaIndex: number,\r\n  pointBbIndex: number,\r\n  massdk: any\r\n) => {\r\n  let textBalloon = \"\";\r\n  if (index === pointAaIndex) textBalloon = \"Начало\";\r\n  if (index === pointBbIndex) textBalloon = \"Конец\";\r\n  return {\r\n    hintContent: massdk[index].nameCoordinates, //balloonContent: PressBalloon(index), iconCaption: textBalloon,\r\n    iconContent: textBalloon,\r\n  };\r\n};\r\n\r\nexport const getPointOptions = (\r\n  index: number,\r\n  pointAaIndex: number,\r\n  pointBbIndex: number,\r\n  massdk: any\r\n) => {\r\n  let colorBalloon = \"islands#violetStretchyIcon\";\r\n  if (massdk[index].newCoordinates > 0)\r\n    colorBalloon = \"islands#darkOrangeStretchyIcon\";\r\n  if (index === pointAaIndex) colorBalloon = \"islands#redStretchyIcon\";\r\n  if (index === pointBbIndex) colorBalloon = \"islands#darkBlueStretchyIcon\";\r\n  return {\r\n    preset: colorBalloon,\r\n  };\r\n};\r\n\r\n//=== addRoute =====================================\r\n\r\nexport const getReferencePoints = (pointA: any, pointB: any) => {\r\n  return {\r\n    referencePoints: [pointA, pointB],\r\n  };\r\n};\r\n\r\nexport const getMultiRouteOptions = () => {\r\n  return {\r\n    routeActiveStrokeWidth: 5,\r\n    //routeActiveStrokeColor: \"#224E1F\",\r\n    routeStrokeWidth: 1.5,\r\n  };\r\n};\r\n\r\nexport const getMassPolyRouteOptions = () => {\r\n  return {\r\n    balloonCloseButton: false,\r\n    strokeColor: \"#1A9165\",\r\n    strokeWidth: 3,\r\n  };\r\n};\r\n\r\nexport const getMassMultiRouteOptions = () => {\r\n  return {\r\n    balloonCloseButton: false,\r\n    routeStrokeStyle: \"dot\",\r\n    strokeColor: \"#1A9165\",\r\n    routeActiveStrokeWidth: 3,\r\n    routeStrokeWidth: 0,\r\n  };\r\n};\r\n\r\nexport const getMassMultiRouteInOptions = () => {\r\n  return {\r\n    routeActiveStrokeWidth: 3,\r\n    routeStrokeStyle: \"dot\",\r\n    routeActiveStrokeColor: \"#E91427\",\r\n    routeStrokeWidth: 0,\r\n  };\r\n};\r\n\r\n//=== костыль ======================================\r\nlet a0 = {\r\n  region: 0,\r\n  starts: \"55.7276995,36.8193915\",\r\n  stops: \"55.69928816060674,37.39474443074465\",\r\n  length: 56425,\r\n  time: 2792,\r\n};\r\nlet a1 = {\r\n  region: 0,\r\n  starts: \"55.7276995,36.8193915\",\r\n  stops: \"55.60238311111584,36.483017680936115\",\r\n  length: 30452,\r\n  time: 1790,\r\n};\r\nlet a2 = {\r\n  region: 0,\r\n  starts: \"55.7276995,36.8193915\",\r\n  stops: \"55.62968055298542,37.021400723452174\",\r\n  length: 22476,\r\n  time: 1430,\r\n};\r\nlet a3 = {\r\n  region: 0,\r\n  starts: \"55.62968055298542,37.021400723452174\",\r\n  stops: \"55.69928816060674,37.39474443074465\",\r\n  length: 31326,\r\n  time: 1808,\r\n};\r\nlet a4 = {\r\n  region: 0,\r\n  starts: \"55.69928816060674,37.39474443074465\",\r\n  stops: \"55.905786101735075,37.7174511711464\",\r\n  length: 46435,\r\n  time: 2667,\r\n};\r\nlet a5 = {\r\n  region: 0,\r\n  starts: \"55.69928816060674,37.39474443074465\",\r\n  stops: \"55.913241655910504,37.8378230903432\",\r\n  length: 50578,\r\n  time: 2600,\r\n};\r\nlet a6 = {\r\n  region: 0,\r\n  starts: \"55.913241655910504,37.8378230903432\",\r\n  stops: \"55.905786101735075,37.7174511711464\",\r\n  length: 11600,\r\n  time: 1174,\r\n};\r\nlet a7 = {\r\n  region: 0,\r\n  starts: \"55.69928816060674,37.39474443074465\",\r\n  stops: \"55.65943211246696,37.92773938370481\",\r\n  length: 47717,\r\n  time: 2627,\r\n};\r\nlet a8 = {\r\n  region: 0,\r\n  starts: \"55.65619605179316,38.10076639140717\",\r\n  stops: \"55.408054,36.7174221\",\r\n  length: 112201,\r\n  time: 6766,\r\n};\r\nlet a9 = {\r\n  region: 0,\r\n  starts: \"55.60238311111584,36.483017680936115\",\r\n  stops: \"55.7276995,36.8193915\",\r\n  length: 32653,\r\n  time: 1924,\r\n};\r\nexport let massOtladka = [a0, a1, a2, a3, a4, a5, a6, a7, a8, a9];\r\n","import { MASSDK_CREATE } from './types';\r\nimport { massDk } from './../App';\r\n\r\nconst intialState = {\r\n  massdk: massDk,\r\n};\r\n\r\nexport const massdkReducer = (state = intialState, action: any) => {\r\n  //console.log('massfazReducer:', action);\r\n  switch (action.type) {\r\n    case MASSDK_CREATE:\r\n      return {\r\n        ...state,\r\n        massdk: action.data,\r\n      };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { MASSROUTE_CREATE } from './types';\r\nimport { massRoute } from './../App';\r\n\r\nconst intialState = {\r\n  massroute: massRoute,\r\n};\r\n\r\nexport const massrouteReducer = (state = intialState, action: any) => {\r\n  switch (action.type) {\r\n    case MASSROUTE_CREATE:\r\n      return {\r\n        ...state,\r\n        massroute: action.data,\r\n      };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { MAP_CREATE } from './types';\r\n\r\n//import { dateRpuGl } from './../App';\r\nimport { dateMapGl } from './../App';\r\n\r\nconst intialState = {\r\n  map: dateMapGl,\r\n};\r\n\r\nexport const mapReducer = (state = intialState, action: any) => {\r\n  //console.log('mapReducer:', action);\r\n  switch (action.type) {\r\n    case MAP_CREATE:\r\n      return {\r\n        ...state,\r\n        map: action.data,\r\n      };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { combineReducers } from 'redux';\r\n//import { commReducer } from './commReducer';\r\nimport { massdkReducer } from './massdkReducer';\r\nimport { massrouteReducer } from './massrouteReducer';\r\nimport { mapReducer } from './mapReducer';\r\n\r\nexport const rootReducer = combineReducers({\r\n  //commReducer,\r\n  mapReducer,\r\n  massdkReducer,\r\n  massrouteReducer,\r\n});\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport { createStore } from 'redux';\r\nimport { rootReducer } from './redux/rootReducer';\r\nimport { Provider } from 'react-redux';\r\n\r\nimport './index.css';\r\nimport App from './App';\r\n\r\nconst store = createStore(\r\n    rootReducer,\r\n    // compose(\r\n    //   applyMiddleware(\r\n    //     thunk,\r\n    //     spamFilter\r\n    //   ),\r\n    //   // window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__(),\r\n    // ),\r\n);\r\n\r\n\r\n\r\nReactDOM.render(\r\n    <Provider store={store}>\r\n        <App />\r\n    </Provider>,\r\n    document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}